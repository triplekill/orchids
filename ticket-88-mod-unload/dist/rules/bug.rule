
rule bug {
  state init {
    if (.syslog.prog == "bug")
      goto end;
  }

  state end {
/*    print(" *** BUG! ***\n");*/
    noop();
  }
}


rule ok1 {

  state init {
    if (.syslog.prog == "ok" && .syslog.msg == "start")
      goto state1;
  }

  state state1 {
    $pid = .syslog.pid;
    /* print("Start of OK"); */
    if (.syslog.prog == "ok" && .syslog.msg == "end" && .syslog.pid == $pid)
      goto state2;
  }

  state state2 {
    noop();
/*    print("End of OK");*/
  }  
}
