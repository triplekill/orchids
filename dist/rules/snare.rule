/*
 * snare rules
 */


rule snare_rule
{
  state init {
    expect (.snare.syscall == "(5) SYS_open")
      goto fopen;
  }

  state fopen {
    $pouet = .snare.path;
    expect (.snare.syscall == "(11) SYS_execve")
      goto alert;
  }

  state alert {
    dump_stack();
  }

}
